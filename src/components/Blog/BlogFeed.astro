---
import CardBlog from "./CardBlog.astro";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

const blogEntries = await getCollection("blog", ({ id }) => {
  return id;
});

const blogPosts: CollectionEntry<"blog">[] = blogEntries.sort(
  (a: CollectionEntry<"blog">, b: CollectionEntry<"blog">) =>
    b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const mostRecentPost: CollectionEntry<"blog"> = blogPosts.splice(0, 1)[0];
const threeMorePosts: CollectionEntry<"blog">[] = blogPosts.splice(0, 2);

const data = {
  title: "M2A Aviation Academy Blog",
  subTitle: "Mission-focused insights, training tips from the cadre, and industry news for future wingmen.",
};
---

<section class="mx-auto max-w-7xl my-12 px-4 lg:px-0 py-6 lg:py-12 flex flex-col items-center">
    <h2
        class="title !text-lucky-950 text-center"
        >
        {data.title}
    </h2>
    <h3 class="!font-sans !not-italic !text-xl max-w-xl !text-muted-950 text-center mb-8">
    {data.subTitle}
    </h3>

  <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
    <CardBlog blogEntry={mostRecentPost} />
    <div class="flex flex-col gap-4 row-start-2 md:row-start-auto">
      {
        threeMorePosts.map((blogEntry) => (
          <CardBlog blogEntry={blogEntry} smallCard={true} />
        ))
      }
    </div>
  </div>

    <div class="flex w-full justify-end pt-8">
    <a href="/blog" class="btn-primary !px-8 !py-4 !text-xl">Read More</a>
    </div>
</section>