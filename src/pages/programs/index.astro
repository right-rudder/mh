---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import HeroGeneralPages from "../../components/HeroGeneralPages.astro";
import FinalCTASection from "../../components/FinalCTASection.astro";
import { PHONE_NUMBER } from "../../data/consts";
import ProgramsOverviewSectionCard from "../../components/Programs/ProgramsOverviewSectionCard.astro";
import MaintenancePhilosophy from "../../components/Fleet/MaintenancePhilosophy.astro";
import LocationSectionBlack from "../../components/LocationSectionBlack.astro";

const programsEntries = await getCollection("programs");
const sortedPrograms = programsEntries.sort((a, b) => {
  return (a.data.order || 99) - (b.data.order || 99);
});

const heroData = {
  images: [
    {
      src: "/src/assets/instructing/mh-aviation-instructing-student-how-to-repair-at-lancaster-california.webp",
      alt: "MH Aviation Flight Training Fleet",
    },
  ],
  title: "Professional Flight<br> Training Programs",
  subTitle: "Structured paths from Private Pilot to the region's only Multi-Engine program. Train in a modern fleet maintained to Part 145 standards.",
};

const finalCtaData = {
  eyebrow: "Start Your Engines",
  headline: "Your Flight Deck<br>Is Waiting",
  bodyCopy:
    "Whether you're training for the airlines or personal mastery, our family-owned environment provides the professional precision you need.",
  cta: {
    text: "Enroll Now",
    href: "/enroll",
    subtext: `Call us at ${PHONE_NUMBER}`,
  },
  image: {
    src:  "/src/assets/instructing/mh-aviation-instructing-on-top-of-plane.jpg",
    alt: "Instructor and student reviewing charts",
  },
};

const locationData = {
  eyebrow: "Strategic Location",
  headline: "Train Where The<br> Skies Are Clear",
  bodyCopy:
    "Located at Gen. William Fox Airfield (KWJF) in Lancaster, CA. Enjoy the scenic high desert views and learn to master real-world wind conditions without the heavy congestion of busy city airports.",
};

const metaProps = {
  siteTitle: "Flight Training Programs | MH Aviation",
  siteDescription: "Antelope Valley's premier training programs. Private, Instrument, Commercial, and Multi-Engine courses at competitive rates.",
  siteKeywords: "Multi-engine rating, Private Pilot, Commercial Pilot, MH Aviation Lancaster"
};
---

<BaseLayout {...metaProps}>
  
  <HeroGeneralPages data={heroData} />

<section class="py-16 md:py-32 bg-ink-50 min-h-screen px-4 overflow-hidden">
    <div class="max-w-7xl mx-auto">
      
      <div class="max-w-3xl mx-auto text-center mb-20 reveal-text opacity-0 translate-y-8 transition-all duration-1000 ease-out">
        <span class="text-ochre-600 font-bold uppercase tracking-widest text-sm mb-2 block">
          Pilot Training Catalog
        </span>
        <h2 class="title text-[2.5rem] md:text-[4rem] uppercase !font-main-header tracking-wide text-ink-950 leading-[1.1]">
          The Pathway to <br/>Professional Mastery
        </h2>
        <p class="mt-8 text-xl text-ink-600 leading-relaxed">
          At MH Aviation, your training is supported by a Part 145 Repair Station ecosystem. This ensures <strong>less downtime</strong> and a higher standard of safety for every hour in your logbook.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-12 lg:gap-16">
        {sortedPrograms.map((program, index) => (
          <ProgramsOverviewSectionCard program={program} index={index} />
        ))}
      </div>
    </div>
  </section>
  <MaintenancePhilosophy/>
  <LocationSectionBlack data={locationData}/>
  <FinalCTASection data={finalCtaData} />

</BaseLayout>

<script>
  const observerOptions = { threshold: 0.1 };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.remove('opacity-0', 'translate-y-8');
        entry.target.classList.add('opacity-100', 'translate-y-0');
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  document.querySelectorAll('.reveal-text, .program-card').forEach((el) => observer.observe(el));
</script>